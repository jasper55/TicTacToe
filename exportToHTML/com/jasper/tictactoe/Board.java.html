<html>
<head>
<title>Board.java</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.ln { color: #999999; font-weight: normal; font-style: normal; }
.s0 { color: rgb(0,0,128); font-weight: bold; }
.s1 { color: rgb(0,0,0); }
.s2 { color: rgb(0,0,255); }
.s3 { color: rgb(101,138,186); font-weight: bold; }
</style>
</head>
<BODY BGCOLOR="#ffffff">
<TABLE CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<TR><TD><CENTER>
<FONT FACE="Arial, Helvetica" COLOR="#000000">
Board.java</FONT>
</center></TD></TR></TABLE>
<pre>
<span class="s0">package </span><span class="s1">com.jasper.tictactoe; 
 
</span><span class="s0">import </span><span class="s1">android.content.Intent; 
</span><span class="s0">import </span><span class="s1">android.support.v7.app.AppCompatActivity; 
</span><span class="s0">import </span><span class="s1">android.os.Bundle; 
</span><span class="s0">import </span><span class="s1">android.view.Menu; 
</span><span class="s0">import </span><span class="s1">android.view.MenuItem; 
</span><span class="s0">import </span><span class="s1">android.view.View; 
</span><span class="s0">import </span><span class="s1">android.widget.Button; 
</span><span class="s0">import </span><span class="s1">android.widget.TableLayout; 
</span><span class="s0">import </span><span class="s1">android.widget.TableRow; 
</span><span class="s0">import </span><span class="s1">android.widget.TextView; 
 
</span><span class="s0">public class </span><span class="s1">Board </span><span class="s0">extends </span><span class="s1">AppCompatActivity { 
 
 
    </span><span class="s0">private static final int </span><span class="s1">PLAYBOARD_DIM = </span><span class="s2">3</span><span class="s1">; 
    </span><span class="s0">private </span><span class="s1">TableLayout playboard; 
    </span><span class="s0">private </span><span class="s1">TextView tvWhosTurn; 
    </span><span class="s0">private char </span><span class="s1">[][] boardState; 
    </span><span class="s0">private char </span><span class="s1">whosTurn; 
 
    </span><span class="s0">private static final int </span><span class="s1">GAME_CONTINUE = </span><span class="s2">0</span><span class="s1">; 
    </span><span class="s0">private static final int </span><span class="s1">GAME_DRAW = -</span><span class="s2">1</span><span class="s1">; 
    </span><span class="s0">private static final int </span><span class="s1">X_WINS = </span><span class="s2">1</span><span class="s1">; 
    </span><span class="s0">private static final int </span><span class="s1">O_WINS = </span><span class="s2">2</span><span class="s1">; 
 
 
    @Override 
    </span><span class="s0">protected void </span><span class="s1">onCreate(Bundle savedInstanceState) { 
        </span><span class="s0">super</span><span class="s1">.onCreate(savedInstanceState); 
        setContentView(R.layout.activity_board); 
 
        boardState = </span><span class="s0">new char </span><span class="s1">[PLAYBOARD_DIM][PLAYBOARD_DIM]; 
        playboard = (TableLayout) findViewById(R.id.mainBoard); 
        tvWhosTurn = (TextView) findViewById(R.id.whos_turn); 
 
        resetBoard(); 
        tvWhosTurn.setText(</span><span class="s3">&quot;Turn: &quot; </span><span class="s1">+ whosTurn); 
 
        initBoard(); 
 
        Button resetBtn = (Button) findViewById(R.id.reset_Btn); 
        resetBtn.setOnClickListener(</span><span class="s0">new </span><span class="s1">View.OnClickListener() { 
            @Override 
            </span><span class="s0">public void </span><span class="s1">onClick(View v) { 
                Intent current = getIntent(); 
                finish(); 
                startActivity(current); 
            } 
        }); 
    } 
 
    </span><span class="s0">private void </span><span class="s1">initBoard() { 
        </span><span class="s0">for</span><span class="s1">(</span><span class="s0">int </span><span class="s1">columnIndex = </span><span class="s2">0</span><span class="s1">; columnIndex &lt; playboard.getChildCount(); columnIndex++){ 
            TableRow row = (TableRow) playboard.getChildAt(columnIndex); 
            </span><span class="s0">for</span><span class="s1">(</span><span class="s0">int </span><span class="s1">rowIndex = </span><span class="s2">0</span><span class="s1">; rowIndex &lt; row.getChildCount(); rowIndex++){ 
                TextView tvCell = (TextView) row.getChildAt(rowIndex); 
                tvCell.setText(R.string.none); 
                tvCell.setOnClickListener(Move(columnIndex, rowIndex, tvCell)); 
            } 
        } 
    } 
 
    </span><span class="s0">protected void </span><span class="s1">resetBoard(){ 
        whosTurn = </span><span class="s3">'X'</span><span class="s1">; 
        </span><span class="s0">for</span><span class="s1">(</span><span class="s0">int </span><span class="s1">i = </span><span class="s2">0</span><span class="s1">; i&lt; PLAYBOARD_DIM; i++){ 
            </span><span class="s0">for</span><span class="s1">(</span><span class="s0">int </span><span class="s1">j = </span><span class="s2">0</span><span class="s1">; j&lt; PLAYBOARD_DIM; j++){ 
                boardState[i][j] = </span><span class="s3">' '</span><span class="s1">; 
            } 
        } 
    } 
 
    </span><span class="s0">protected int </span><span class="s1">updateGameStatus(){ 
 
        </span><span class="s0">for</span><span class="s1">(</span><span class="s0">int </span><span class="s1">cellIndex = </span><span class="s2">0</span><span class="s1">; cellIndex &lt; PLAYBOARD_DIM; cellIndex++){ 
            </span><span class="s0">if</span><span class="s1">(checkRowEquality(cellIndex,</span><span class="s3">'X'</span><span class="s1">)) 
                </span><span class="s0">return </span><span class="s1">X_WINS; 
            </span><span class="s0">if</span><span class="s1">(checkColumnEquality(cellIndex, </span><span class="s3">'X'</span><span class="s1">)) 
                </span><span class="s0">return </span><span class="s1">X_WINS; 
            </span><span class="s0">if</span><span class="s1">(checkRowEquality(cellIndex,</span><span class="s3">'O'</span><span class="s1">)) 
                </span><span class="s0">return </span><span class="s1">O_WINS; 
            </span><span class="s0">if</span><span class="s1">(checkColumnEquality(cellIndex,</span><span class="s3">'O'</span><span class="s1">)) 
                </span><span class="s0">return </span><span class="s1">O_WINS; 
            </span><span class="s0">if</span><span class="s1">(checkDiagonal(</span><span class="s3">'X'</span><span class="s1">)) 
                </span><span class="s0">return </span><span class="s1">X_WINS; 
            </span><span class="s0">if</span><span class="s1">(checkDiagonal(</span><span class="s3">'O'</span><span class="s1">)) 
                </span><span class="s0">return </span><span class="s1">O_WINS; 
        } 
 
        </span><span class="s0">boolean </span><span class="s1">boardFull = </span><span class="s0">true</span><span class="s1">; 
        </span><span class="s0">for</span><span class="s1">(</span><span class="s0">int </span><span class="s1">i = </span><span class="s2">0</span><span class="s1">; i&lt; PLAYBOARD_DIM; i++){ 
            </span><span class="s0">for</span><span class="s1">(</span><span class="s0">int </span><span class="s1">j = </span><span class="s2">0</span><span class="s1">; j&lt; PLAYBOARD_DIM; j++){ 
                </span><span class="s0">if</span><span class="s1">(boardState[i][j]==</span><span class="s3">' '</span><span class="s1">) 
                    boardFull = </span><span class="s0">false</span><span class="s1">; 
            } 
        } 
        </span><span class="s0">if</span><span class="s1">(boardFull) 
            </span><span class="s0">return </span><span class="s1">GAME_DRAW; 
        </span><span class="s0">else return </span><span class="s1">GAME_CONTINUE; 
    } 
 
    </span><span class="s0">protected boolean </span><span class="s1">checkDiagonal(</span><span class="s0">char </span><span class="s1">playerChar){ 
        </span><span class="s0">int </span><span class="s1">playerCharCount = </span><span class="s2">0</span><span class="s1">,computerCharCount = </span><span class="s2">0</span><span class="s1">; 
 
        </span><span class="s0">for </span><span class="s1">(</span><span class="s0">int </span><span class="s1">index = </span><span class="s2">0</span><span class="s1">; index&lt; PLAYBOARD_DIM; index++) { 
            </span><span class="s0">if </span><span class="s1">(boardState[index][index] == playerChar) 
                playerCharCount++; 
        } 
 
        </span><span class="s0">for </span><span class="s1">(</span><span class="s0">int </span><span class="s1">index = </span><span class="s2">0</span><span class="s1">; index &lt; PLAYBOARD_DIM; index++) { 
            </span><span class="s0">if </span><span class="s1">(boardState[index][PLAYBOARD_DIM - </span><span class="s2">1 </span><span class="s1">- index] == playerChar) 
                computerCharCount++; 
        } 
 
        </span><span class="s0">return </span><span class="s1">(playerCharCount == PLAYBOARD_DIM || computerCharCount == PLAYBOARD_DIM); 
    } 
 
    </span><span class="s0">protected boolean </span><span class="s1">checkRowEquality(</span><span class="s0">int </span><span class="s1">rowIndex, </span><span class="s0">char </span><span class="s1">playerChar){ 
        </span><span class="s0">int </span><span class="s1">playerCharCount=</span><span class="s2">0</span><span class="s1">; 
 
        </span><span class="s0">for</span><span class="s1">(</span><span class="s0">int </span><span class="s1">columnIndex = </span><span class="s2">0</span><span class="s1">; columnIndex&lt; PLAYBOARD_DIM; columnIndex++){ 
            </span><span class="s0">if</span><span class="s1">(boardState[rowIndex][columnIndex]==playerChar) 
                playerCharCount++; 
        } 
 
        </span><span class="s0">return </span><span class="s1">(playerCharCount == PLAYBOARD_DIM); 
    } 
 
    </span><span class="s0">protected boolean </span><span class="s1">checkColumnEquality(</span><span class="s0">int </span><span class="s1">columnIndex, </span><span class="s0">char </span><span class="s1">playerChar){ 
        </span><span class="s0">int </span><span class="s1">playerCharCount=</span><span class="s2">0</span><span class="s1">; 
 
        </span><span class="s0">for</span><span class="s1">(</span><span class="s0">int </span><span class="s1">rowIndex = </span><span class="s2">0</span><span class="s1">; rowIndex&lt; PLAYBOARD_DIM; rowIndex++){ 
            </span><span class="s0">if</span><span class="s1">(boardState[rowIndex][columnIndex]==playerChar) 
                playerCharCount++; 
        } 
 
        </span><span class="s0">return </span><span class="s1">(playerCharCount == PLAYBOARD_DIM); 
    } 
 
    </span><span class="s0">protected boolean </span><span class="s1">isCellSet(</span><span class="s0">int </span><span class="s1">rowIndex, </span><span class="s0">int </span><span class="s1">columnIndex){ 
        </span><span class="s0">return </span><span class="s1">!(boardState[rowIndex][columnIndex]==</span><span class="s3">' '</span><span class="s1">); 
    } 
 
    </span><span class="s0">protected void </span><span class="s1">stopMatch(){ 
        </span><span class="s0">for</span><span class="s1">(</span><span class="s0">int </span><span class="s1">cellNumber = </span><span class="s2">0</span><span class="s1">; cellNumber &lt; playboard.getChildCount(); cellNumber++){ 
            TableRow rowIndex = (TableRow) playboard.getChildAt(cellNumber); 
            </span><span class="s0">for</span><span class="s1">(</span><span class="s0">int </span><span class="s1">columnIndex = </span><span class="s2">0</span><span class="s1">; columnIndex &lt; rowIndex.getChildCount(); columnIndex++){ 
                TextView tv = (TextView) rowIndex.getChildAt(columnIndex); 
                tv.setOnClickListener(</span><span class="s0">null</span><span class="s1">); 
            } 
        } 
    } 
 
    View.OnClickListener Move(</span><span class="s0">final int </span><span class="s1">rowIndex, </span><span class="s0">final int </span><span class="s1">columnIndex, </span><span class="s0">final </span><span class="s1">TextView boardCellText){ 
 
        </span><span class="s0">return new </span><span class="s1">View.OnClickListener() { 
            @Override 
            </span><span class="s0">public void </span><span class="s1">onClick(View v) { 
 
                </span><span class="s0">if</span><span class="s1">(!isCellSet(rowIndex,columnIndex)) { 
                    boardState[rowIndex][columnIndex] = whosTurn; 
                    </span><span class="s0">if </span><span class="s1">(whosTurn == </span><span class="s3">'X'</span><span class="s1">) { 
                        boardCellText.setText(R.string.X); 
                        whosTurn = </span><span class="s3">'O'</span><span class="s1">; 
                    } </span><span class="s0">else if </span><span class="s1">(whosTurn == </span><span class="s3">'O'</span><span class="s1">) { 
                        boardCellText.setText(R.string.O); 
                        whosTurn = </span><span class="s3">'X'</span><span class="s1">; 
                    } 
                    </span><span class="s0">if </span><span class="s1">(updateGameStatus() == </span><span class="s2">0</span><span class="s1">) { 
                        tvWhosTurn.setText(</span><span class="s3">&quot;Turn: &quot; </span><span class="s1">+ whosTurn); 
                    } 
                    </span><span class="s0">else if</span><span class="s1">(updateGameStatus() == -</span><span class="s2">1</span><span class="s1">){ 
                        tvWhosTurn.setText(</span><span class="s3">&quot;Game: Draw&quot;</span><span class="s1">); 
                        stopMatch(); 
                    } 
                    </span><span class="s0">else</span><span class="s1">{ 
                        tvWhosTurn.setText(whosTurn +</span><span class="s3">&quot; loses!&quot;</span><span class="s1">); 
                        stopMatch(); 
                    } 
                } 
                </span><span class="s0">else</span><span class="s1">{ 
                    tvWhosTurn.setText(tvWhosTurn.getText()+</span><span class="s3">&quot; Please choose a Cell Which is not already Occupied&quot;</span><span class="s1">); 
                } 
            } 
        }; 
    } 
 
    @Override 
    </span><span class="s0">public boolean </span><span class="s1">onCreateOptionsMenu(Menu menu) { 
        getMenuInflater().inflate(R.menu.menu_board, menu); 
        </span><span class="s0">return true</span><span class="s1">; 
    } 
 
    @Override 
    </span><span class="s0">public boolean </span><span class="s1">onOptionsItemSelected(MenuItem item) { 
        </span><span class="s0">int </span><span class="s1">id = item.getItemId(); 
        </span><span class="s0">if </span><span class="s1">(id == R.id.action_settings) { 
            </span><span class="s0">return true</span><span class="s1">; 
        } 
        </span><span class="s0">return super</span><span class="s1">.onOptionsItemSelected(item); 
    } 
} 
</span></pre>
</body>
</html>